# Example lefthook configuration for commitment
# Place this file in your project root

prepare-commit-msg:
  skip:
    - merge
    - rebase
  commands:
    commitment:
      # Run for regular commits only
      # {1} is the commit message file path
      # {2} is commit source: "message" (from -m), "template", "merge", "squash", or "commit"
      # When no source (regular git commit), lefthook doesn't substitute {2}
      run: |
        # Only run if {2} contains curly braces (unsubstituted = regular commit)
        # Skip if {2} = "message", "template", etc. (user already provided message)
        case "{2}" in
          *"{"*) npx commitment generate --message-only > "{1}" ;;
        esac
      interactive: true

# Optional: Add pre-commit hooks for linting
# pre-commit:
#   parallel: true
#   commands:
#     lint:
#       glob: "*.{js,ts,jsx,tsx}"
#       run: npm run lint -- --fix {staged_files}
#       stage_fixed: true
#     format:
#       glob: "*.{js,ts,jsx,tsx,json,md}"
#       run: npm run format -- {staged_files}
#       stage_fixed: true
